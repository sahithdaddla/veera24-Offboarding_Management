<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Offboarding Data</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #4361ee;
      --primary-light: #4895ef;
      --primary-dark: #3f37c9;
      --secondary: #f72585;
      --accent: #4cc9f0;
      --dark: #1a1a2e;
      --light: #f8f9fa;
      --gray: #6c757d;
      --gray-light: #e9ecef;
      --success: #38b000;
      --warning: #ffaa00;
      --danger: #ef233c;
      --border-radius: 12px;
      --box-shadow: 0 10px 30px rgba(0, 0, 0, 0.29);
      --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Poppins', -apple-system, BlinkMacSystemFont, sans-serif;
      line-height: 1.6;
      color: var(--dark);
      min-height: 100vh;
    }

    header {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      text-align: center;
      padding: 3rem 1.5rem;
      margin-bottom: 2rem;
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    header::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
      transform: rotate(30deg);
      z-index: 1;
    }

    h1 {
      font-size: clamp(2rem, 5vw, 2.5rem);
      font-weight: 700;
      margin-bottom: 1rem;
      position: relative;
      z-index: 2;
      text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .header-quote {
      font-size: clamp(1rem, 3vw, 1.125rem);
      opacity: 0.9;
      position: relative;
      z-index: 2;
      font-weight: 300;
      max-width: 800px;
      margin: 0 auto;
    }

    main {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 1.5rem 3rem;
    }

    .filter-section {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      padding: 1.5rem;
      margin-bottom: 2rem;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      align-items: start;
    }

    .filter-section > div {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .filter-section label {
      font-weight: 500;
      color: var(--dark);
    }

    .filter-section input,
    .filter-section select {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid var(--gray-light);
      border-radius: 8px;
      font-size: 1rem;
      transition: var(--transition);
      font-family: 'Poppins', sans-serif;
    }

    .filter-section input:focus,
    .filter-section select:focus {
      border-color: var(--primary);
      outline: none;
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
    }

    .filter-section select {
      appearance: none;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 1rem center;
      background-size: 1em;
    }

    .filter-section button {
      background: linear-gradient(135deg, var(--secondary), var(--danger));
      color: white;
      border: none;
      border-radius: 8px;
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      align-self: center;
    }

    .filter-section button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(247, 37, 133, 0.3);
    }

    .data-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 2rem;
      margin-top: 2rem;
    }

    .card {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      padding: 1.5rem;
      transition: var(--transition);
      border: 1px solid rgba(0, 0, 0, 0.05);
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 5px;
      height: 100%;
      background: linear-gradient(to bottom, var(--primary), var(--secondary));
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
    }

    .data-section {
      margin-bottom: 1.5rem;
    }

    .data-section h2 {
      font-size: 1.25rem;
      color: var(--primary);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.9rem;
    }

    .data-section h2 i {
      color: var(--secondary);
    }

    .data-row {
      display: flex;
      margin-bottom: 0.75rem;
      align-items: flex-end;
    }

    .data-label {
      font-weight: 500;
      color: var(--gray);
      min-width: 120px;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .data-label i {
      color: var(--primary-light);
      width: 20px;
      text-align: center;
    }

    .data-value {
      flex: 1;
      word-break: break-word;
    }

    .view-more-btn {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      border: none;
      border-radius: 50px;
      padding: 0.75rem 1.5rem;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-top: 1rem;
      margin: 0 auto;
    }

    .view-more-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(67, 97, 238, 0.3);
    }

    .view-more-btn i {
      font-size: 0.8rem;
    }

    .no-data {
      text-align: center;
      color: var(--gray);
      font-style: italic;
      padding: 2rem;
      grid-column: 1 / -1;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      animation: fadeIn 0.3s ease-out;
    }

    .modal-content {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: 0 10px 50px rgba(0, 0, 0, 0.2);
      max-width: 800px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      padding: 2rem;
      position: relative;
      transform: translateY(20px);
      opacity: 0;
      animation: slideUp 0.3s ease-out forwards;
      box-sizing: border-box;
    }

    .close-btn {
      position: absolute;
      top: 1rem;
      right: 1rem;
      font-size: 1.5rem;
      background: none;
      border: none;
      cursor: pointer;
      color: var(--gray);
      transition: var(--transition);
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
    }

    .close-btn:hover {
      background-color: var(--gray-light);
      color: var(--danger);
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes slideUp {
      from { 
        transform: translateY(20px);
        opacity: 0;
      }
      to { 
        transform: translateY(0);
        opacity: 1;
      }
    }

    @media (max-width: 768px) {
      header {
        padding: 2rem 1rem;
      }

      .filter-section {
        grid-template-columns: 1fr;
      }

      .filter-section button {
        align-self: center;
        width: 100%;
      }

      .data-container {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 480px) {
      .data-row {
        flex-direction: column;
        gap: 0.25rem;
      }

      .data-label {
        min-width: auto;
      }

      .modal-content {
        padding: 1rem;
        margin: 0 0.5rem;
      }
    }

    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      padding: 0.25rem 0.75rem;
      border-radius: 50px;
      font-size: 0.75rem;
      font-weight: 500;
      text-transform: uppercase;
    }

    .status-active {
      background-color: rgba(56, 176, 0, 0.1);
      color: var(--success);
    }

    .status-inactive {
      background-color: rgba(239, 35, 60, 0.1);
      color: var(--danger);
    }

    .department-engineering {
      color: var(--primary);
    }

    .department-marketing {
      color: var(--secondary);
    }

    .department-hr {
      color: #9c27b0;
    }

    .department-finance {
      color: #ff9800;
    }
  </style>
</head>
<body>
  <header>
    <h1>Offboarding Data</h1>
    <div class="header-quote">
      <p>"Employee records help us remember and appreciate every contribution made to our organization."</p>
    </div>
  </header>
  
  <main>
    <section class="filter-section">
      <div>
        <label for="searchInput">Search by Name or ID</label>
        <input type="text" id="searchInput" placeholder="Enter name or ID...">
      </div>
      <div>
        <label for="departmentFilter">Department</label>
        <select id="departmentFilter">
          <option value="">All Departments</option>
          <option value="Engineering">Engineering</option>
          <option value="Marketing">Marketing</option>
          <option value="HR">Human Resources</option>
          <option value="Finance">Finance</option>
        </select>
      </div>
      <div>
        <label for="positionFilter">Position</label>
        <input type="text" id="positionFilter" placeholder="Enter position...">
      </div>
      <div>
        <button id="clearFilters">Clear Filters</button>
      </div>
    </section>
    <div class="data-container" id="dataDisplay">
      <!-- Data will be displayed here -->
    </div>
    <div class="modal" id="detailsModal">
      <div class="modal-content">
        <button class="close-btn" id="closeModal">Ã—</button>
        <div id="modalContent">
          <!-- Modal content will be inserted here -->
        </div>
      </div>
    </div>
  </main>
  
  <script>
    document.addEventListener('DOMContentLoaded', async function() {
      const dataDisplay = document.getElementById('dataDisplay');
      const modal = document.getElementById('detailsModal');
      const modalContent = document.getElementById('modalContent');
      const closeModal = document.getElementById('closeModal');
      const searchInput = document.getElementById('searchInput');
      const departmentFilter = document.getElementById('departmentFilter');
      const positionFilter = document.getElementById('positionFilter');
      const clearFilters = document.getElementById('clearFilters');
      
      let allEmployees = []; // Store all employee data

      // Function to fetch employee data from the backend
      async function fetchEmployees() {
        try {
          const response = await fetch('http://localhost:3000/api/offboarding', {
            method: 'GET',
            headers: { 'Content-Type': 'application/json' }
          });
          
          if (!response.ok) {
            throw new Error('Failed to fetch employee data');
          }
          
          const employees = await response.json();
          return employees;
        } catch (error) {
          console.error('Error fetching data:', error);
          dataDisplay.innerHTML = '<div class="no-data">Error fetching employee data. Please try again later.</div>';
          return [];
        }
      }

      // Function to filter employees based on search and filter inputs
      function filterEmployees() {
        const searchTerm = searchInput.value.toLowerCase().trim();
        const department = departmentFilter.value;
        const position = positionFilter.value.toLowerCase().trim();

        const filteredEmployees = allEmployees.filter(employee => {
          const matchesSearch = !searchTerm || 
            employee.empName.toLowerCase().includes(searchTerm) || 
            employee.empId.toLowerCase().includes(searchTerm);
          
          const matchesDepartment = !department || 
            employee.department === department;
          
          const matchesPosition = !position || 
            employee.position.toLowerCase().includes(position);

          return matchesSearch && matchesDepartment && matchesPosition;
        });

        renderEmployees(filteredEmployees);
      }

      // Function to render employees
      function renderEmployees(employees) {
        dataDisplay.innerHTML = '';
        
        if (employees.length === 0) {
          dataDisplay.innerHTML = '<div class="no-data">No employee data matches the current filters</div>';
          return;
        }
        
        employees.forEach((data, index) => {
          const html = `
            <div class="card" id="employee-${index}">
              <div class="data-section">
                <h2><i class="fas fa-user"></i> ${data.empName}</h2>
                <div class="data-row">
                  <div class="data-label"><i class="fas fa-briefcase"></i> Position:</div>
                  <div class="data-value">${data.position}</div>
                </div>
                <div class="data-row">
                  <div class="data-label"><i class="fas fa-building"></i> Department:</div>
                  <div class="data-value">${data.department}</div>
                </div>
                <div class="data-row">
                  <div class="data-label"><i class="fas fa-id-card"></i> Employee ID:</div>
                  <div class="data-value">${data.empId}</div>
                </div>
                <button class="view-more-btn" data-index="${index}">
                  <i class="fas fa-chevron-right"></i> View Details
                </button>
              </div>
            </div>
          `;
          dataDisplay.insertAdjacentHTML('beforeend', html);
        });

        // Add event listeners for view more buttons
        document.querySelectorAll('.view-more-btn').forEach(button => {
          button.addEventListener('click', function() {
            const index = this.getAttribute('data-index');
            const data = employees[index];
            
            // Populate modal content
            modalContent.innerHTML = `
              <div class="data-section">
                <h2><i class="fas fa-info-circle"></i> Employee Information</h2>
                <div class="data-row">
                  <div class="data-label"><i class="fas fa-user"></i> Employee Name:</div>
                  <div class="data-value">${data.empName}</div>
                </div>
                <div class="data-row">
                  <div class="data-label"><i class="fas fa-briefcase"></i> Position:</div>
                  <div class="data-value">${data.position}</div>
                </div>
                <div class="data-row">
                  <div class="data-label"><i class="fas fa-building"></i> Department:</div>
                  <div class="data-value">${data.department}</div>
                </div>
                <div class="data-row">
                  <div class="data-label"><i class="fas fa-id-card"></i> Employee ID:</div>
                  <div class="data-value">${data.empId}</div>
                </div>
              </div>
              <div class="data-section">
                <h2><i class="fas fa-comment-dots"></i> Exit Interview</h2>
                <div class="data-row">
                  <div class="data-label"><i class="fas fa-comment-alt"></i> Feedback:</div>
                  <div class="data-value">${data.feedback}</div>
                </div>
              </div>
              <div class="data-section">
                <h2><i class="fas fa-file-invoice-dollar"></i> Final Settlement</h2>
                <div class="data-row">
                  <div class="data-label"><i class="fas fa-money-bill-wave"></i> Final Salary:</div>
                  <div class="data-value">$${data.finalSalary.toLocaleString()}</div>
                </div>
                <div class="data-row">
                  <div class="data-label"><i class="fas fa-gift"></i> Bonus Amount:</div>
                  <div class="data-value">$${data.bonus.toLocaleString()}</div>
                </div>
                <div class="data-row">
                  <div class="data-label"><i class="fas fa-calculator"></i> Total Settlement:</div>
                  <div class="data-value">$${(data.finalSalary + data.bonus).toLocaleString()}</div>
                </div>
                <div class="data-row">
                  <div class="data-label"><i class="fas fa-file-signature"></i> Acknowledgment:</div>
                  <div class="data-value">${data.acknowledgment}</div>
                </div>
              </div>
            `;
            
            // Show modal
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden'; // Prevent scrolling
          });
        });
      }
      
      // Close modal
      closeModal.addEventListener('click', function() {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
      });
      
      // Close modal when clicking outside
      modal.addEventListener('click', function(event) {
        if (event.target === modal) {
          modal.style.display = 'none';
          document.body.style.overflow = 'auto';
        }
      });

      // Event listeners for filters
      searchInput.addEventListener('input', filterEmployees);
      departmentFilter.addEventListener('change', filterEmployees);
      positionFilter.addEventListener('input', filterEmployees);

      // Clear filters
      clearFilters.addEventListener('click', function() {
        searchInput.value = '';
        departmentFilter.value = '';
        positionFilter.value = '';
        filterEmployees();
      });
      
      // Fetch and render employee data
      allEmployees = await fetchEmployees();
      renderEmployees(allEmployees);
    });
  </script>
</body>
</html>